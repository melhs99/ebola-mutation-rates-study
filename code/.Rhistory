n=7*6*5*4*3*2*1
r=3*2*1
c=n/r*(n-r)
n/c
library(ape)
aln<-read.dna("ebov_2014_early.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"/")
decimal_dates <- vector()
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
paste0(rownames(aln),"@",decimal_dates)
rownames(aln)<-paste0(rownames(aln),"@",decimal_dates)
write.dna(aln,"ebola_2014.fasta",format="fasta")
setwd("~/Documents/GitHub/ebola-mutation-rates-study/DCR_detailed_analyses")
library(ape)
aln<-read.dna("vipr_dcr_data.fasta",format="fasta")
dates<-gsub(".+[|]","",rownames(aln))
date_temp<-strsplit(dates,"_")
decimal_dates <- vector()
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
paste0(rownames(aln),"@",decimal_dates)
library(ape)
aln<-read.dna("vipr_dcr_data.fasta",format="fasta")
aln
labels(aln)
library(ape)
aln<-read.dna("vipr_dcr_data.fasta",format="fasta")
dates<-gsub(".+[|]","",rownames(aln))
date_temp<-strsplit(dates,"_")
decimal_dates <- vector()
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
aln
date_temp
labels(Aln)
labels(alm)
labels(aln)
library(ape)
aln<-read.dna("vipr_dcr_data.fasta",format="fasta")
dates<-gsub(".+[|]","",rownames(aln))
dates
library(ape)
aln<-read.dna("vipr_dcr_data.fasta",format="fasta")
dates<-gsub(".+[|]","",labels(aln))
dates
date_temp<-strsplit(dates,"_")
date_temp
decimal_dates <- vector()
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
decimal_dates
paste0(rownames(aln),"@",decimal_dates)
paste0(labels(aln),"@",decimal_dates)
labels(aln)<-paste0(labels(aln),"@",decimal_dates)
labels(aln)
labels(aln)<-paste0(labels(aln),"@",decimal_dates)
library(ape)
aln<-read.dna("vipr_dcr_data.fasta",format="fasta")
dates<-gsub(".+[|]","",labels(aln))
date_temp<-strsplit(dates,"_")
decimal_dates <- vector()
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
paste0(labels(aln),"@",decimal_dates)
labels(aln)<-paste0(labels(aln),"@",decimal_dates)
labels(aln)<-paste0(names(aln),"@",decimal_dates)
names(aln)<-paste0(names(aln),"@",decimal_dates)
names(aln)
library(ape)
aln<-read.dna("vipr_dcr_data.fasta",format="fasta")
dates<-gsub(".+[|]","",labels(aln))
date_temp<-strsplit(dates,"_")
decimal_dates <- vector()
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
paste0(labels(aln),"@",decimal_dates)
names(aln)<-paste0(names(aln),"@",decimal_dates)
write.dna(aln,"vipr_dcr_data.fasta",format="fasta")
setwd("~/Documents/GitHub/ebola-mutation-rates-study/code")
#make_xml(seq_data, template_strict_dates, output)
dir("../ebola_fasta_files/")
input_files<-paste0("../ebola_fasta_files/", "vipr_dcr_data.fasta")
input_data<-read.dna(input_files[1],format="fasta")
#make_xml(seq_data, template_strict_dates, output)
dir("../ebola_fasta_files/")
library(ape)
input_files<-paste0("../ebola_fasta_files/", "vipr_dcr_data.fasta")
input_data<-read.dna(input_files[1],format="fasta")
#make_xml(seq_data, template_strict_dates, output)
dir("../DCR_detailed_analyses/")
library(ape)
input_files<-paste0("../DCR_detailed_analyses/", "vipr_dcr_data.fasta")
input_data<-read.dna(input_files[1],format="fasta")
source("make_xmls_GSS.R")
input_files
#make_xml(seq_data, template_strict_dates, output)
dir("../DCR_detailed_analyses/")
library(ape)
input_files<-paste0("../DCR_detailed_analyses/", "vipr_dcr_data.fasta")
input_data<-read.dna(input_files,format="fasta")
input_files
input_data
source("make_xmls_GSS.R")
input_files
library(ape)
input_data<-read.dna(input_files[1],format="fasta")
iput_data
input_data
input_files
#make_xml(seq_data, template_strict_dates, output)
dir("../DCR_detailed_analyses/")
library(ape)
input_files<-paste0("../DCR_detailed_analyses/", "vipr_dcr_data.fasta")
input_data<-read.dna(input_files,format="fasta")
source("make_xmls_GSS.R")
input_files
library(ape)
input_data<-read.dna(input_files,format="fasta")
e
#make_xml(seq_data, template_strict_dates, output)
dir("../DCR_detailed_analyses/")
library(ape)
input_files<-paste0("../DCR_detailed_analyses/", "vipr_dcr_data.fasta")
input_data<-read.dna(input_files,format="fasta")
iput_files
input_files
input_data
source("make_xmls_GSS.R")
input_files
input_files<-paste0("../DCR_detailed_analyses/", "vipr_dcr_data.fasta")
input_data<-read.dna(input_files,format="fasta")
input_files
input_data
make_xml(input_data,template_strict_dates,'vipr_dcr_data_sc_het')
