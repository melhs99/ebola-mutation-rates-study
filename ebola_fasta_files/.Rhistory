n=7*6*5*4*3*2*1
r=3*2*1
c=n/r*(n-r)
n/c
library(ape)
aln<-read.dna("ebov_2014_early.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"/")
decimal_dates <- vector()
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
paste0(rownames(aln),"@",decimal_dates)
rownames(aln)<-paste0(rownames(aln),"@",decimal_dates)
write.dna(aln,"ebola_2014.fasta",format="fasta")
setwd("~/Documents/GitHub/ebola-mutation-rates-study/ebola_fasta_files")
#sort dates
library(ape)
aln<-read.dna("ebola_early2014.fasta",format="fasta")
length(rownames(aln))
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
seg.sites(aln)
length(seg.sites(aln))
aln<-read.dna("ebola_2018Public.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
length(rownames(aln))
#variable sites
seg.sites(aln)
length(seg.sites(aln))
aln<-read.dna("ebola_2018Public.fasta",format="fasta")
length(aln)
length(rownames(aln))
#sort dates
library(ape)
aln<-read.dna("ebola_liberia.fasta",format="fasta")
length(rownames(aln))
b
b
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
#variable sites
seg.sites(aln)
length(seg.sites(aln))
aln<-read.dna("2018-2019_without_outgroup.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
length(rownames(aln))
#variable sites
seg.sites(aln)
length(seg.sites(aln))
aln<-read.dna("2014_large_3.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
head(sort(dates_deci))
tail(sort(dates_deci))
length(rownames(aln))
#variable sites
seg.sites(aln)
length(seg.sites(aln))
aln<-read.dna("subset1_aln.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
#variable sites
seg.sites(aln)
length(seg.sites(aln))
length(rownames(aln))
aln<-read.dna("subset2_aln.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
#variable sites
seg.sites(aln)
length(seg.sites(aln))
length(rownames(aln))
aln<-read.dna("subset3_aln.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
length(rownames(aln))
aln<-read.dna("Democratic_Republic_of_the_Congo_subset.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
#variable sites
seg.sites(aln)
length(seg.sites(aln))
length(rownames(aln))
aln<-read.dna("sierra_leone_testoutput.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
head(sort(dates_deci))
tail(sort(dates_deci))
#variable sites
seg.sites(aln)
length(seg.sites(aln))
length(rownames(aln))
aln<-read.dna("guinea_testout.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
#variable sites
seg.sites(aln)
length(seg.sites(aln))
length(rownames(aln))
aln<-read.dna("Liberia_subset.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
#variable sites
seg.sites(aln)
length(seg.sites(aln))
length(rownames(aln))
aln<-read.dna("2014-2014.5_subset.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
#variable sites
seg.sites(aln)
length(seg.sites(aln))
length(rownames(aln))
aln<-read.dna("2014.5-2015_subset.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
head(sort(dates_deci))
tail(sort(dates_deci))
#variable sites
seg.sites(aln)
length(seg.sites(aln))
length(rownames(aln))
aln<-read.dna("2015-2015.5_subset.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
#variable sites
seg.sites(aln)
length(seg.sites(aln))
length(rownames(aln))
aln<-read.dna("2015.5-2016_subset.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
dates_deci<-gsub(".+[@]","",dates)
sort(dates_deci)
#variable sites
seg.sites(aln)
length(seg.sites(aln))
length(rownames(aln))
