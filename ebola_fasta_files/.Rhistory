n=7*6*5*4*3*2*1
r=3*2*1
c=n/r*(n-r)
n/c
library(ape)
aln<-read.dna("ebov_2014_early.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"/")
decimal_dates <- vector()
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
paste0(rownames(aln),"@",decimal_dates)
rownames(aln)<-paste0(rownames(aln),"@",decimal_dates)
write.dna(aln,"ebola_2014.fasta",format="fasta")
setwd("~/Documents/GitHub/ebola-mutation-rates-study/ebola_fasta_files")
library(ape)
aln<-read.dna("2014_large_3.fasta",format="fasta")
aln
rownames(aln)
names(aln)
colnames(aln)
gsub("|.*|_|.*", "", subtree1$tip.label)
library(ape)
subtree1 <- read.nexus('subtree_1.tree')
library(ape)
aln<-read.dna("2014_large_3.fasta",format="fasta")
aln
rownames(aln)
?strsplit
strsplit(rownames(aln),"|")
rownames(aln)
strsplit(rownames(aln),"|")
strsplit(rownames(aln),"| ")
strsplit(rownames(aln),"|")
library(ape)
aln<-read.dna("2014_large_3.fasta",format="fasta")
rownames(aln)
row<-rownames(aln)
row
strsplit(row,"|")
strsplit(rownames(aln),'|')
strsplit('rownames(aln)','|')
strsplit(rownames(aln),"'|'")
strsplit(rownames(aln),"|")
rownames(aln)[,3]
rownames(aln)
strsplit(rownames(aln),"|")
strsplit(rownames(aln),"[|]")
split<-strsplit(rownames(aln),"[|]")
split
split[3]
split[[3]]
split[,3]
split[1,3]
split[[1]][3]
split[[]][3]
split[[i]][3]
split[3]
split[[3]]
split[[]][3]
rownames(aln)
split
head(split)
split[[]],[3]
gsub("[|].*|_[|].*","",rownames(aln))
?gsub
split<-strsplit(rownames(aln),"[|]")
split
?lapply
lapply(r,split {return(aln[3])},aln)
lapply(r,split,return(aln[3]),aln)
r<-rownames(aln)
lapply(r,split,return(aln[3]),aln)
lapply(r,split,return(aln[[3]]),aln)
lapply(r,split,return(aln[[i]]),aln)
lapply(r,split,return(aln[i]),aln)
place <- vector()
for(i in 1:length(split)){
split[[i]]<-split[[i]][3]
}
for(i in 1:length(split)){
place<-split[[i]][3]
}
rownames(spline())
rownames(split)
names(split)
split
library(ape)
aln<-read.dna("2014_large_3.fasta",format="fasta")
split<-strsplit(rownames(aln),"[|]")
place <- vector()
for(i in 1:length(split)){
place<-split[[i]][3]
}
place
split
length(split)
for(i in 1:length(split)){
split[[i]]<-split[[i]][3]
}
place
library(ape)
aln<-read.dna("2014_large_3.fasta",format="fasta")
split<-strsplit(rownames(aln),"[|]")
place <- vector()
for(i in 1:length(split)){
split[[i]]<-split[[i]][3]
}
place
for(i in 1:length(split)){
split[[i]]<-as.character(split[[i]])
place[i]<-split[[i]][3]
}
place
split[[1]][3]
library(ape)
aln<-read.dna("2014_large_3.fasta",format="fasta")
split<-strsplit(rownames(aln),"[|]")
split
split[[1]][3]
place <- vector()
for(i in 1:length(split)){
split[[i]]<-as.character(split[[i]])
place[i]<-split[[i]][3]
}
place
place$"Sierra_Leone"
place[Sierra_Leone]
?sort
sort(place,"Sierra_Leone")
names(place)
grep("Sierra_Leone",place,value=T)
sl<-grep("Sierra_Leone",place,value=T)
sl
names(sl)
sl %in% rownames(aln)
sl %in% place
length(sl %in% place)
sl<-sl %in% place
sl %in% rownames(aln)
length(sl %in% rownames(aln))
sl<-sl %in% rownames(aln)
Sierra_Leone<-aln[rownames(aln) %in% sl,]
Sierra_Leone
grep("Sierra_Leone",place,value=T)
