points((1:nrow(data)),data$rate.estimate.ucld.het,pch=20,col="darkgrey")
points((1:nrow(data))+0.25,data$lsd_rate,pch=2,cex=0.7)
points((1:nrow(data))+0.25,data$slope..rate,pch=4,cex=0.5)
dev.off()
data=read.csv("rate_estimates.csv",stringsAsFactors = F)
data[,-1]<-log10(data[,-1])
pdf("rates_barplots.pdf",useDingbats = F,width=10, height=5)
par(mar=c(6,4,4,4))
plot(c(0,18),range(-6,-1),type="n", xlab="", ylab="evol.rate(sub/site/year)",
xaxt="n")
axis(side=1, at=1:17, label= data$dataset,las=2,cex.axis=0.7)
for(i in 1:nrow(data)){
lines(rep(i-0.25,2),c(data$sc.het_lower[i],data$sc.het_upper[i]))
lines(rep(i,2),c(data$ucld.het_lower[i],data$ucld.het_upper[i]),col="darkgrey")
}
points((1:nrow(data))-0.25,data$rate.estimate.sc.het,pch=20)
points((1:nrow(data)),data$rate.estimate.ucld.het,pch=20,col="darkgrey")
points((1:nrow(data))+0.25,data$lsd_rate,pch=2,cex=0.7)
points((1:nrow(data))+0.25,data$slope..rate,pch=4,cex=0.5)
dev.off()
setwd("~/Documents/GitHub/ebola-mutation-rates-study/ebola_fasta_files/DCR_combine_data")
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
aln
dates<-gsub(".+[_]","",rownames(aln))
dates
date_temp<-strsplit(dates,"-")
date_temp
decimal_dates <- vector()
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
warnings()
date_temp
decimal_dates <- vector()
date_temp[[i]][2]
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"-")
date_temp
decimal_dates <- vector()
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"-")
decimal_dates <- vector()
for(i in 1:length(date_temp)){}
for(i in 1:length(date_temp)){}
decimal_dates <- vector()
for(i in 1:length(date_temp)){
if("May"(date_temp[[i]][2] )){
date_temp[[i]][2]=5
}
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"-")
for(i in 1:length(date_temp)){
if("May"(date_temp[[i]][2] )){
date_temp[[i]][2]=5
}
for(i in 1:length(date_temp)){
if("May"(date_temp[[i]][2] )){
date_temp[[i]][2]=5
}}
for(i in 1:length(date_temp)){
if(date_temp[[i]][2]="May" )){
date_temp[[i]][2]=5
}}
for(i in 1:length(date_temp)){
if(date_temp[[i]][2]="May" ))
date_temp[[i]][2]=5
}
for(i in 1:length(date_temp))
if(date_temp[[i]][2]="May" ))
date_temp[[i]][2]=5
for(i in 1:length(date_temp))
if((date_temp[[i]][2])="May" ))
date_temp[[i]][2]=5
for(i in 1:length(date_temp))
if(date_temp[[i]][2]<-"May" ))
date_temp[[i]][2]=5
for(i in 1:length(date_temp))
if(date_temp[[i]][2]<-"May" )
date_temp[[i]][2]=5
for(i in 1:length(date_temp)){
if(date_temp[[i]][2]<-"May" )
date_temp[[i]][2]=5}
for(i in 1:length(date_temp)){
if(date_temp[[i]][2]<-"May"){
date_temp[[i]][2]=5}
}
months()
months.Date(date_temp)
month.name
months()
date_temp
date_temp<-c("May","Jun","Aug","Dec")
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"-")
month<-c("May","Jun","Aug","Dec")
match(tst,month.abb)
match(month,month.abb)
match(date_temp[[i]][2],month.abb)
match(date_temp,month.abb)
month<-c("May","Jun","Aug","Dec")
match(month,month.abb)
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
else(match(date_temp[[i]][2],month.abb))
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
warnings()
date_temp
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"-")
date_temps
date_temp
date_temp[[i]][2]
date_temp[[2]][2]
date_temp[[2]][2]<-match(date_temp[[2]][2],month.abb)
date_temp
date_temp[[3]][2]<-match(date_temp[[3]][2],month.abb)
date_temp[[i]][2]<-match(date_temp[[i]][2],month.abb)
date_temp
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"-")
date_temp[[2]][2]<-match(date_temp[[2]][2],month.abb)
for(i in 1:length(date_temp)){
match(date_temp[[i]][2],month.abb)
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
date_temp
date_temp[[2]][2]<-match(date_temp[[2]][2],month.abb)
for(i in 1:length(date_temp)){
match(date_temp[[i]][2],month.abb)
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
date_temp
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"-")
decimal_dates <- vector()
date_temp[[2]][2]<-match(date_temp[[2]][2],month.abb)
for(i in 1:length(date_temp)){
match(date_temp[[i]][2],month.abb)
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
date_temp
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"-")
for(i in 1:length(date_temp)){
match(date_temp[[i]][2],month.abb)
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
date_temp
for(i in 1:length(date_temp)){
if  date_temp[[i]][2]<-as.character(date_temp[[i]][2]){
match(date_temp[[i]][2],month.abb)
}
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
for(i in 1:length(date_temp)){
if  date_temp[[i]][2]<-as.character(date_temp[[i]][2])
match(date_temp[[i]][2],month.abb)
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
for(i in 1:length(date_temp)){
if  (date_temp[[i]][2]<-as.character(date_temp[[i]][2]))
match(date_temp[[i]][2],month.abb)
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
for(i in 1:length(date_temp)){
for(i in 1:length(date_temp)){
if  (date_temp[[i]][2]<-as.character(date_temp[[i]][2]))
match(date_temp[[i]][2],month.abb)
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
for(i in 1:length(date_temp)){
if  (date_temp[[i]][2]<-as.character(date_temp[[i]][2]))
match(date_temp[[i]][2],month.abb)
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
for(i in 1:length(date_temp)){
if  (date_temp[[i]][2]<-as.character(date_temp[[i]][2]))
match(date_temp[[i]][2],month.abb)
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
for(i in 1:length(date_temp)){
if  (date_temp[[i]][2]<-as.character(date_temp[[i]][2])){
match(date_temp[[i]][2],month.abb)
}
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
for(i in 1:length(date_temp)){
if  (date_temp[[i]][2]<-as.character(date_temp[[i]][2])){
match(date_temp[[i]][2],month.abb)
}
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
for(i in 1:length(date_temp)){
if  (date_temp[[i]][2]<-as.character(date_temp[[i]][2])){
match(date_temp[[i]][2],month.abb)
}
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"-")
for(i in 1:length(date_temp)){
if  (date_temp[[i]][2]<-as.character(date_temp[[i]][2])){
match(date_temp[[i]][2],month.abb)
}
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
for(i in 1:length(date_temp)){
date_temp[[i]][2]<-as.character(date_temp[[i]][2]){
match(date_temp[[i]][2],month.abb)
}
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
for(i in 1:length(date_temp)){
date_temp[[i]][2]<-as.character(date_temp[[i]][2]){
match(date_temp[[i]][2],month.abb)
}
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
for(i in 1:length(date_temp)){
date_temp[[i]][2]<-as.character(date_temp[[i]][2])
match(date_temp[[i]][2],month.abb)
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
date_temp
for(i in 1:length(date_temp)){
date_temp[[i]][2]<-as.character(date_temp[[i]][2])
if(as.character(date_temp[[i]][2])){
match(date_temp[[i]][2],month.abb)}
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
for(i in 1:length(date_temp)){
date_temp[[i]][2]<-as.character(date_temp[[i]][2])
if(is.character(date_temp[[i]][2])){
match(date_temp[[i]][2],month.abb)}
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
date_temp
for(i in 1:length(date_temp)){
if(is.character(date_temp[[i]][2])){
match(date_temp[[i]][2],month.abb)}
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
date_temp
character(date_temp)
length(date_temp)
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"-")
for(i in 1:length(date_temp)){
if(is.character(date_temp[[i]][2])){
match(date_temp[[i]][2],month.abb)}
if (is.na(date_temp[[i]][2])){
date_temp[[i]][2]=6
}
}
date_temp
date_temp[[2]][2]<-match(date_temp[[2]][2],month.abb)
date_temp[[3]][2]<-match(date_temp[[3]][2],month.abb)
date_temp[[4]][2]<-match(date_temp[[4]][2],month.abb)
date_temp[[5]][2]<-match(date_temp[[5]][2],month.abb)
date_temp[[6]][2]<-match(date_temp[[6]][2],month.abb)
date_temp[[7]][2]<-match(date_temp[[7]][2],month.abb)
date_temp[[8]][2]<-match(date_temp[[8]][2],month.abb)
date_temp[[9]][2]<-match(date_temp[[9]][2],month.abb)
date_temp[[17]][2]<-match(date_temp[[17]][2],month.abb)
date_temp[[18]][2]<-match(date_temp[[18]][2],month.abb)
date_temp[[23]][2]<-match(date_temp[[23]][2],month.abb)
date_temp
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
decimal_dates
aln1<-read.dna("combined_DCR",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp1<-strsplit(dates,"-")
aln1<-read.dna("combined_DCR.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp1<-strsplit(dates,"-")
date_temp1
library(ape)
aln<-read.dna("lam_sequences.fasta",format="fasta")
dates<-gsub(".+[_]","",rownames(aln))
date_temp<-strsplit(dates,"-")
date_temp[[2]][2]<-match(date_temp[[2]][2],month.abb)
date_temp[[3]][2]<-match(date_temp[[3]][2],month.abb)
date_temp[[4]][2]<-match(date_temp[[4]][2],month.abb)
date_temp[[5]][2]<-match(date_temp[[5]][2],month.abb)
date_temp[[6]][2]<-match(date_temp[[6]][2],month.abb)
date_temp[[7]][2]<-match(date_temp[[7]][2],month.abb)
date_temp[[8]][2]<-match(date_temp[[8]][2],month.abb)
date_temp[[9]][2]<-match(date_temp[[9]][2],month.abb)
date_temp[[17]][2]<-match(date_temp[[17]][2],month.abb)
date_temp[[18]][2]<-match(date_temp[[18]][2],month.abb)
date_temp[[23]][2]<-match(date_temp[[23]][2],month.abb)
date_temp
decimal_dates <- vector()
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
decimal_dates
date_temp[[2]][1]<-2014
date_temp[[2]][3]<-26
date_temp[[3]][1]<-2014
date_temp[[3]][3]<-27
date_temp[[4]][1]<-2014
date_temp[[4]][3]<-15
date_temp[[5]][1]<-2014
date_temp[[5]][3]<-16
date_temp[[6]][1]<-2014
date_temp[[6]][3]<-28
date_temp[[7]][1]<-2014
date_temp[[7]][3]<-25
date_temp[[8]][1]<-2014
date_temp[[8]][3]<-28
date_temp[[9]][1]<-2014
date_temp[[9]][3]<-28
date_temp[[17]][1]<-2007
date_temp[[17]][3]<-31
date_temp[[18]][1]<-2008
date_temp[[18]][3]<-31
date_temp[[23]][1]<-1995
date_temp[[23]][3]<-04
date_temp
for(i in 1:length(date_temp)){
date_temp[[i]]<-as.numeric(date_temp[[i]])
if(is.na(date_temp[[i]][2] )){
date_temp[[i]][2]=6
}
if(is.na(date_temp[[i]][3])){
date_temp[[i]][3]=15
}
decimal_dates[i]<-date_temp[[i]][1]+date_temp[[i]][2]/13+date_temp[[i]][3]/366
}
decimal_dates
paste0(rownames(aln),"@",decimal_dates)
rownames(aln)<-paste0(rownames(aln),"@",decimal_dates)
write.dna(aln,"lam_sequences_dates.fasta",format="fasta")
rownames(subset)
names(subset)
rownames(subset1)
rownames("subset1")
library(ape)
complete_aln<-read.dna("mafft_combined_DCR.fasta",format = "fasta")
subset1 <- read.tree('lam_sequences_dates',format = "fasta")
library(ape)
complete_aln<-read.dna("mafft_combined_DCR.fasta",format = "fasta")
subset1 <- read.dna('lam_sequences_dates',format = "fasta")
library(ape)
complete_aln<-read.dna("mafft_combined_DCR.fasta",format = "fasta")
subset1 <- read.dna('lam_sequences_dates.fasta',format = "fasta")
rownames("subset1")
subset1
labels("subset1")
labels("subset1")
rownames("subset1")
names("subset1")
rownames(complete_aln)
subset1 %in% rownames(complete_aln)
subset1 %in% complete_aln
complete_DRC<-complete_aln[complete_aln %in% subset1,]
subset1 %in% complete_aln
subset1
length(subset1)
labels(subset1)
length(labels(subset1))
length(subset1 %in% complete_aln)
length(labels(subset1 %in% complete_aln))
library(ape)
complete_aln<-read.dna("mafft_combined_DCR.fasta",format = "fasta")
subset1 <- read.dna('lam_sequences_dates.fasta',format = "fasta")
subset1 %in% complete_aln
complete_DRC<-complete_aln[complete_aln %in% subset1,]
complete_DRC<-complete_aln[complete_aln %in% subset1]
complete_DRC
library(ape)
complete_DRC<-complete_aln[complete_aln %in% subset1,]
library(ape)
complete_aln<-read.dna("mafft_combined_DCR.fasta",format = "fasta")
subset1 <- read.dna('lam_sequences_dates.fasta',format = "fasta")
subset1 %in% complete_aln
complete_DRC<-complete_aln[complete_aln %in% subset1,]
complete_DRC<-complete_aln[subset1 %in% complete_aln,]
complete_DRC<-complete_aln[complete_aln %in% subset1, drop=F]
complete_DRC
library(ape)
complete_aln<-read.dna("mafft_combined_DCR.fasta",format = "fasta")
subset1 <- read.dna('lam_sequences_dates.fasta',format = "fasta")
subset1 %in% complete_aln
complete_DRC<-complete_aln[complete_aln %in% subset1,]
rownames(subset1)
rownames(complete_aln)
subset1_label<-gsub('@'','',subset1)
subset1_label<-gsub('@','',subset1)
subset1_label
subset1_label<-gsub('@','',rownames(subset1))
subset1_label
subset1_label%in% rownames(complete_aln)
subset1_label %in% rownames(complete_aln)
subset1_label
rownames(complete_aln)
subset1_label<-gsub('\','@',rownames(subset1))
subset1_label<-gsub('@','',rownames(subset1))
subset1_label %in% rownames(complete_aln)
subset1_label<-gsub('@','',rownames(subset1))
subset1_label
subset1_label<-gsub('@.+','',rownames(subset1))
subset1_label
subset1_label %in% rownames(complete_aln)
complete_DRC<-complete_aln[complete_aln %in% subset1_label,]
complete_DRC<-complete_aln[!complete_aln %in% subset1_label,]
complete_DRC<-complete_aln[!rownames(complete_aln) %in% subset1_label,]
complete_DRC
subset1
rbind(complete_DRC,subset1)
DRC_subset_dates<-rbind(complete_DRC,subset1)
DRC_subset_dates
write.dna(DRC_subset_dates,"complete_DRC.fasta",format="fasta")
rownames(complete_DRC)
